openapi: 3.0.3
info:
  title: GigaOffice API
  description: |
    API for GigaOffice spreadsheet processing with AI capabilities.
    
    Промежуточный сервер для интеграции плагинов Р7-Офис с AI-моделью GigaChat.
    • Хранит заявки и метаданные в PostgreSQL  
    • Обменивается заданиями и ответами через Kafka (топики *gigaoffice-requests*, *gigaoffice-responses*, *gigaoffice-dlq*)
  version: 1.0.0
servers:
  - url: http://localhost:8000
    description: Local development server
  - url: https://omv-gigaoffice.ydns.eu
    description: Production

components:
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT

  schemas:
    # Health schemas
    PingResponse:
      type: object
      properties:
        status:
          type: string
          example: pong
      description: Simple ping response to check if the service is alive

    ServiceHealth:
      type: object
      properties:
        status:
          type: string
          default: ok
        timestamp:
          type: string
          format: date-time
        version:
          type: string
          default: 1.0.0
        uptime:
          type: number
          format: float
        database:
          type: boolean
          default: true
        gigachat:
          type: boolean
          default: true
        kafka:
          type: boolean
          default: true
        active_requests:
          type: integer
          default: 0
        queue_size:
          type: integer
          default: 0
        memory_usage:
          type: number
          format: float
          default: 0.0
        cpu_usage:
          type: number
          format: float
          default: 0.0
      description: Detailed service health information including database, GigaChat, and Kafka status

    # AI Feedback schemas
    AIFeedbackCreate:
      type: object
      required:
        - ai_request_id
        - text_response
      properties:
        ai_request_id:
          type: string
        text_response:
          type: string
        rating:
          type: boolean
          nullable: true
        comment:
          type: string
          nullable: true
      description: Model for creating AI feedback

    AIFeedbackOut:
      type: object
      properties:
        id:
          type: integer
        ai_request_id:
          type: string
          format: uuid
        text_response:
          type: string
        rating:
          type: boolean
          nullable: true
        comment:
          type: string
          nullable: true
      description: Model for AI feedback output

    # Prompt schemas
    PromptCategoriesResponse:
      type: object
      properties:
        status:
          type: string
        categories:
          type: array
          items:
            $ref: '#/components/schemas/CategoryInfo'
      description: Response for prompt categories

    CategoryInfo:
      type: object
      properties:
        id:
          type: integer
        name:
          type: string
        display_name:
          type: string
        description:
          type: string
          nullable: true
        is_active:
          type: boolean
        sort_order:
          type: integer
        prompt_count:
          type: integer
      description: Information about a prompt category

    CategoryDetailsResponse:
      type: object
      properties:
        status:
          type: string
        category:
          $ref: '#/components/schemas/CategoryInfo'
        prompts:
          type: array
          items:
            $ref: '#/components/schemas/PromptInfo'
      description: Detailed category information

    PromptInfo:
      type: object
      properties:
        id:
          type: integer
        name:
          type: string
        description:
          type: string
          nullable: true
        template:
          type: string
        category_id:
          type: integer
      description: Information about a prompt

    PresetPromptsResponse:
      type: object
      properties:
        status:
          type: string
        prompts:
          type: array
          items:
            $ref: '#/components/schemas/PresetPromptInfo'
      description: Response for preset prompts

    PresetPromptInfo:
      type: object
      properties:
        id:
          type: integer
        name:
          type: string
        template:
          type: string
        category_id:
          type: integer
        category_name:
          type: string
          nullable: true
        category_display_name:
          type: string
          nullable: true
      description: Information about a preset prompt

    PromptClassificationRequest:
      type: object
      required:
        - prompt_text
      properties:
        prompt_text:
          type: string
          minLength: 1
        include_descriptions:
          type: boolean
          default: false
      description: Request for prompt classification

    PromptClassificationResponse:
      type: object
      properties:
        success:
          type: boolean
        query_text:
          type: string
        category:
          type: string
        confidence:
          type: number
          format: float
        text_content:
          type: string
        required_table_info:
          type: object
          properties:
            needs_column_headers:
              type: boolean
              description: Whether column header names are required
            needs_header_styles:
              type: boolean
              description: Whether header formatting is required
            needs_cell_values:
              type: boolean
              description: Whether actual cell data is required
            needs_cell_styles:
              type: boolean
              description: Whether cell formatting is required
            needs_column_metadata:
              type: boolean
              description: Whether column type information is required
          description: Additional textual content from LLM response
      description: Response for prompt classification

    # Metrics schemas
    MetricsResponse:
      type: object
      properties:
        period:
          type: string
          enum: [hour, day, week, month]
        total_requests:
          type: integer
        successful_requests:
          type: integer
        failed_requests:
          type: integer
        avg_processing_time:
          type: number
          format: float
        total_tokens_used:
          type: integer
      description: Response for service metrics

    # Spreadsheet schemas
    SpreadsheetMetadata:
      type: object
      properties:
        version:
          type: string
          default: "1.0"
          example: "1.0"
        created_at:
          type: string
          format: date-time
      description: Metadata for the enhanced spreadsheet data format

    WorksheetInfo:
      type: object
      properties:
        name:
          type: string
          default: "Sheet1"
          description: Name of the worksheet where source data is located
        range:
          type: string
          default: "A1"
          description: Сell range reference for source data
      description: Worksheet information

    CellStyle:
      type: object
      properties:
        background_color:
          type: string
          nullable: true
          description: Background color in hex format
        font_color:
          type: string
          nullable: true
          description: Font color in hex format
        font_weight:
          type: string
          nullable: true
          description: Font weight (normal, bold)
        font_size:
          type: integer
          nullable: true
          description: Font size in points
        font_style:
          type: string
          nullable: true
          description: Font style (normal, italic)
        horizontal_alignment:
          type: string
          nullable: true
          description: Horizontal alignment (left, center, right)
        vertical_alignment:
          type: string
          nullable: true
          description: Vertical alignment (top, middle, bottom)
        border:
          type: array
          nullable: true
          items:
            type: string
          description: Border settings (top, right, bottom, left)
      description: Unified styling for all spreadsheet cells

    HeaderData:
      type: object
      required:
        - values
      properties:
        values:
          type: array
          items:
            type: string
        style:
          $ref: '#/components/schemas/CellStyle'
      description: Header row definition

    DataRow:
      type: object
      required:
        - values
      properties:
        values:
          type: array
          items:
            oneOf:
              - type: string
              - type: integer
              - type: number
              - type: boolean
        style:
          $ref: '#/components/schemas/CellStyle'
      description: Data row definition

    WorksheetData:
      type: object
      required:
        - rows
      properties:
        header:
          $ref: '#/components/schemas/HeaderData'
          description: Header row data
        rows:
          type: array
          items:
            $ref: '#/components/schemas/DataRow'
          description: Data rows
      description: Worksheet data structure

    ColumnDefinition:
      type: object
      required:
        - index
        - format
      properties:
        index:
          type: integer
          description: Zero-based column index
        format:
          type: string
          description: Display format for the data
      description: Column definition with type and formatting

    ChartPosition:
      type: object
      required:
        - top
        - left
        - width
        - height
      properties:
        top:
          type: integer
          description: Top position in pixels
        left:
          type: integer
          description: Left position in pixels
        width:
          type: integer
          description: Width in pixels
        height:
          type: integer
          description: Height in pixels
      description: Position and size specifications for charts

    ChartStyle:
      type: object
      properties:
        color_scheme:
          type: string
          default: office
          description: Color scheme for the chart
      description: Chart styling options

    ChartDefinition:
      type: object
      required:
        - type
        - title
        - range
        - position
      properties:
        type:
          type: string
          description: Chart type (column, line, pie, etc.)
        title:
          type: string
          description: Chart title
        range:
          type: string
          description: Data range for the chart
        position:
          $ref: '#/components/schemas/ChartPosition'
          description: Position and size specifications
        style:
          $ref: '#/components/schemas/ChartStyle'
          description: Chart styling options
      description: Chart definition

    SpreadsheetData:
      type: object
      properties:
        metadata:
          $ref: '#/components/schemas/SpreadsheetMetadata'
          description: Metadata section
        worksheet:
          $ref: '#/components/schemas/WorksheetInfo'
          description: Worksheet section
        data:
          $ref: '#/components/schemas/WorksheetData'
          description: Data section containing header and rows
        columns:
          type: array
          items:
            $ref: '#/components/schemas/ColumnDefinition'
          nullable: true
          description: Column definitions
        charts:
          type: array
          items:
            $ref: '#/components/schemas/ChartDefinition'
          nullable: true
          description: Chart definitions
      description: Main data structure for enhanced spreadsheet manipulation

    SpreadsheetRequest:
      type: object
      required:
        - spreadsheet_data
        - query_text
      properties:
        spreadsheet_data:
          $ref: '#/components/schemas/SpreadsheetData'
        query_text:
          type: string
        category:
          type: string
          nullable: true
      description: Request model for enhanced spreadsheet processing

    SpreadsheetProcessResponse:
      type: object
      required:
        - success
        - request_id
        - status
        - message
      properties:
        success:
          type: boolean
        request_id:
          type: string
        status:
          type: string
        message:
          type: string
        error_message:
          type: string
          nullable: true
      description: Response model for initiating spreadsheet processing (without result data)

    SpreadsheetResultResponse:
      type: object
      required:
        - success
        - status
        - message
      properties:
        success:
          type: boolean
        status:
          type: string
        message:
          type: string
        result:
          $ref: '#/components/schemas/SpreadsheetData'
        tokens_used:
          type: integer
          nullable: true
        processing_time:
          type: number
          format: float
          nullable: true
      description: Response model for spreadsheet processing result

    SpreadsheetSearchRequest:
      type: object
      required:
        - data
      properties:
        data:
          oneOf:
            - type: string
            - type: array
              items:
                type: string
      description: Request model for spreadsheet data search

    SearchResultItem:
      type: object
      required:
        - text
        - language
        - score
      properties:
        text:
          type: string
          description: Matched text from the database
        language:
          type: string
          description: Language of the matched text
        score:
          type: number
          format: float
          description: Similarity score (0-1, where 1 is most similar)
      description: Search result item with text, language and similarity score

    SearchResult:
      type: object
      required:
        - search_text
        - search_results
      properties:
        search_text:
          type: string
          description: Search prompt text
        search_results:
          type: array
          items:
            $ref: '#/components/schemas/SearchResultItem'
          description: Search result items
      description: Search result

    # File Operation schemas
    FileUploadResponse:
      type: object
      properties:
        success:
          type: boolean
          description: Whether the upload was successful
        file_id:
          type: string
          format: uuid
          description: Unique identifier for the uploaded file
        filename:
          type: string
          description: Original filename of the uploaded file
        size:
          type: integer
          description: File size in bytes
        upload_time:
          type: string
          format: date-time
          description: Timestamp when the file was uploaded
      description: Response model for file upload operation

    ErrorResponse:
      type: object
      properties:
        error:
          type: string
          description: Error code identifier
        message:
          type: string
          description: Human-readable error message
        details:
          type: object
          nullable: true
          description: Additional error details
      description: Standard error response format

    # MCP Task schemas
    SourceRange:
      type: object
      required:
        - sheet_name
      properties:
        sheet_name:
          type: string
          description: Name of the worksheet
        start_cell:
          type: string
          nullable: true
          description: Starting cell reference (e.g., 'A1')
        end_cell:
          type: string
          nullable: true
          description: Ending cell reference (e.g., 'D10')
      description: Source data range specification

    MCPTaskExecuteRequest:
      type: object
      required:
        - prompt
        - file_id
        - user_id
      properties:
        prompt:
          type: string
          minLength: 1
          maxLength: 10000
          description: Natural language task description
        file_id:
          type: string
          format: uuid
          description: UUID of uploaded Excel file
        source_range:
          $ref: '#/components/schemas/SourceRange'
          nullable: true
          description: Optional source data range information
        user_id:
          type: integer
          minimum: 1
          description: User identifier
        priority:
          type: integer
          minimum: 0
          maximum: 10
          default: 0
          description: Task priority level (0-10, higher is more important)
      description: Request model for MCP task execution

    MCPTaskExecuteResponse:
      type: object
      required:
        - task_id
        - status
        - created_at
      properties:
        task_id:
          type: string
          format: uuid
          description: Unique task identifier
        status:
          type: string
          enum: [queued, running, completed, failed]
          default: queued
          description: Current task status
        created_at:
          type: string
          format: date-time
          description: Task creation timestamp
      description: Response model for task execution initiation

    ProgressInfo:
      type: object
      properties:
        current_step:
          type: integer
          minimum: 0
          description: Current step number (1-based)
        total_steps:
          type: integer
          minimum: 0
          description: Total estimated steps
        step_description:
          type: string
          description: Description of current operation
        percentage:
          type: integer
          minimum: 0
          maximum: 100
          description: Completion percentage
      description: Progress information for running task

    ExecutionResult:
      type: object
      required:
        - output_file_id
        - operations_performed
        - execution_time
      properties:
        output_file_id:
          type: string
          format: uuid
          description: UUID of result file
        operations_performed:
          type: array
          items:
            type: string
          description: List of completed operations
        execution_time:
          type: number
          format: float
          minimum: 0
          description: Total execution time in seconds
      description: Task execution result information

    ExecutionError:
      type: object
      required:
        - message
        - failed_step
        - error_type
      properties:
        message:
          type: string
          description: Error description
        failed_step:
          type: string
          description: Step where failure occurred
        error_type:
          type: string
          description: Error classification
      description: Task execution error information

    MCPTaskProgressResponse:
      type: object
      required:
        - task_id
        - status
        - created_at
        - updated_at
      properties:
        task_id:
          type: string
          format: uuid
          description: Task identifier
        status:
          type: string
          enum: [queued, running, completed, failed]
          description: Current status
        progress:
          $ref: '#/components/schemas/ProgressInfo'
          nullable: true
          description: Progress information (only for queued/running tasks)
        result:
          $ref: '#/components/schemas/ExecutionResult'
          nullable: true
          description: Task result (only when completed)
        error:
          $ref: '#/components/schemas/ExecutionError'
          nullable: true
          description: Error information (only when failed)
        created_at:
          type: string
          format: date-time
          description: Task creation timestamp
        updated_at:
          type: string
          format: date-time
          description: Last update timestamp
      description: Response model for task progress retrieval

paths:
  /api/ping:
    get:
      tags:
        - Health
      summary: Simple ping endpoint
      description: |
        Простой health-check endpoint для проверки работоспособности API.
        
        Returns a simple pong response to check if the service is alive
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PingResponse'
              example:
                status: pong

  /api/health:
    get:
      tags:
        - Health
      summary: Detailed service health check
      description: |
        Возвращает детальную информацию о состоянии всех компонентов сервиса.
        
        Returns detailed information about the service health including database, GigaChat, and Kafka status
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ServiceHealth'
              example:
                status: ok
                timestamp: "2023-01-01T00:00:00Z"
                version: "1.0.0"
                uptime: 3600.5
                database: true
                gigachat: true
                kafka: true
                active_requests: 5
                queue_size: 2
                memory_usage: 45.2
                cpu_usage: 12.5

  /api/feedback:
    post:
      tags:
        - AI Feedback Processing
      summary: Submit AI feedback
      description: Submit feedback for an AI request
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AIFeedbackCreate'
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AIFeedbackOut'
        '422':
          description: Validation error
        '500':
          description: Internal server error

  /api/prompts/categories:
    get:
      tags:
        - Prompts
      summary: Get prompt categories
      description: Получение списка категорий предустановленных промптов с описанием
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PromptCategoriesResponse'
        '500':
          description: Internal server error

  /api/prompts/categories/{category_id}:
    get:
      tags:
        - Prompts
      summary: Get category details
      description: Получение подробной информации о категории
      parameters:
        - name: category_id
          in: path
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CategoryDetailsResponse'
        '404':
          description: Category not found
        '500':
          description: Internal server error

  /api/prompts/presets:
    get:
      tags:
        - Prompts
      summary: Get preset prompts
      description: Получение предустановленных промптов
      parameters:
        - name: category
          in: query
          required: false
          schema:
            type: string
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PresetPromptsResponse'
        '500':
          description: Internal server error

  /api/prompts/classify:
    post:
      tags:
        - Prompts
      summary: Classify a prompt
      description: Классифицирует пользовательский промпт по предопределенным категориям
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PromptClassificationRequest'
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PromptClassificationResponse'
        '401':
          description: Unauthorized
        '422':
          description: Validation error
        '500':
          description: Internal server error

  /api/metrics:
    get:
      tags:
        - Metrics
      summary: Get service metrics
      description: Получение метрик сервиса
      security:
        - bearerAuth: []
      parameters:
        - name: period
          in: query
          required: false
          schema:
            type: string
            default: day
            enum: [hour, day, week, month]
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MetricsResponse'
        '401':
          description: Unauthorized
        '403':
          description: Access denied
        '500':
          description: Internal server error

  /api/spreadsheets/process:
    post:
      tags:
        - Spreadsheet Processing
      summary: Process enhanced spreadsheet data
      description: |
        Обработка расширенных данных таблицы.
        
        Process enhanced spreadsheet data with AI
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SpreadsheetRequest'
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SpreadsheetProcessResponse'
        '401':
          description: Unauthorized
        '422':
          description: Validation error
        '500':
          description: Internal server error

  /api/spreadsheets/status/{request_id}:
    get:
      tags:
        - Spreadsheet Processing
      summary: Get processing status
      description: |
        Получение статуса обработки расширенных данных таблицы.
        
        Get the processing status of a spreadsheet request
      parameters:
        - name: request_id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SpreadsheetProcessResponse'
        '404':
          description: Request not found
        '500':
          description: Internal server error

  /api/spreadsheets/result/{request_id}:
    get:
      tags:
        - Spreadsheet Processing
      summary: Get processing result
      description: |
        Получение результата обработки расширенных данных таблицы.
        
        Get the result of a spreadsheet processing request
      parameters:
        - name: request_id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SpreadsheetResultResponse'
        '404':
          description: Request not found
        '500':
          description: Internal server error

  /api/spreadsheets/data/search:
    post:
      tags:
        - Spreadsheet Processing
      summary: Search spreadsheet data
      description: |
        Performs semantic search on spreadsheet headers using vector embeddings to find the most similar matches. Currently only supports searching in the "header" domain.
      security:
        - bearerAuth: []
      parameters:
        - name: domain
          in: query
          required: true
          description: Domain area for search. Currently only supports 'header'
          schema:
            type: string
        - name: limit
          in: query
          required: true
          description: Number of most relevant results to return per search string
          schema:
            type: integer
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SpreadsheetSearchRequest'
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/SearchResult'
        '400':
          description: Invalid domain parameter
        '401':
          description: Unauthorized
        '422':
          description: Validation error
        '500':
          description: Internal server error

  /api/v1/files/upload:
    post:
      tags:
        - File Operations
      summary: Upload Excel file
      description: |
        Upload an Excel file (.xlsx, .xls) to the server.
        
        Maximum file size: 50 MB.
        Returns a unique UUID that can be used to download the file.
      parameters:
        - name: limit
          in: query
          required: false
          description: Rate limit (30 requests per minute)
          schema:
            type: string
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              required:
                - file
              properties:
                file:
                  type: string
                  format: binary
                  description: Excel file to upload
      responses:
        '200':
          description: File uploaded successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/FileUploadResponse'
        '400':
          description: Invalid file or validation error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '413':
          description: File too large (exceeds 50 MB limit)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /api/v1/files/download/{file_id}:
    get:
      tags:
        - File Operations
      summary: Download Excel file
      description: |
        Download an Excel file by UUID.
        
        Retrieves the file with the specified UUID and returns it as a download.
        Optionally deletes the file after successful download.
      parameters:
        - name: file_id
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: UUID of the file to download
        - name: delete_after_download
          in: query
          required: false
          schema:
            type: boolean
            default: false
          description: If true, deletes the file from storage after download
      responses:
        '200':
          description: File downloaded successfully
          content:
            application/octet-stream:
              schema:
                type: string
                format: binary
        '400':
          description: Invalid file_id format
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: File not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /api/v1/spreadsheets/mcp/execute:
    post:
      tags:
        - MCP Task Execution
      summary: Execute MCP task
      description: |
        Initiates asynchronous execution of spreadsheet task using MCP and LLM agent.
        
        Returns immediately with task UUID for progress tracking.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/MCPTaskExecuteRequest'
      responses:
        '200':
          description: Task queued successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MCPTaskExecuteResponse'
        '400':
          description: Invalid request parameters
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: File not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '422':
          description: Validation error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /api/v1/spreadsheets/mcp/progress/{task_id}:
    get:
      tags:
        - MCP Task Execution
      summary: Get MCP task progress
      description: |
        Retrieves current execution status and progress of MCP task.
        
        Returns different information depending on task status:
        - queued/running: includes progress information
        - completed: includes result data
        - failed: includes error information
      parameters:
        - name: task_id
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: Task identifier UUID
      responses:
        '200':
          description: Task progress retrieved successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MCPTaskProgressResponse'
        '400':
          description: Invalid task_id format
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Task not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
prompt: |
  Ты — виртуальный ассистент для анализа данных в электронных таблицах Р7-Офис.
  Всегда предоставляй результат в формате массива массивов, в которых каждый элемент — строка в формате, пригодном для вставки в таблицу.
  Если требуется вычисление статистических показателей, используй формулы, применимые к переданному диапазону ячеек.
  Корреляции, тренды и любые операции анализа выполняй с помощью встроенных статистических функций (например, СРЗНАЧ, МЕДИАНА, КОРРЕЛ, ЛИНЕЙН).
  Даты всегда в формате ДД.ММ.ГГГГ. Формулы — строкой, не вычисляй результат.
  Ответ всегда в виде JSON-массива массивов.
examples:
- request: |
    ЗАДАЧА: Найди минимальное, максимальное, среднее и медианное значения в указанном диапазоне

    ДИАПАЗОН ЯЧЕЕК С ИСХОДНЫМИ ДАННЫМИ: A4:A8
  response: |
    [
      ["Минимум", "=МИН(A4:A8)"],
      ["Максимум", "=МАКС(A4:A8)"],
      ["Среднее", "=СРЗНАЧ(A4:A8)"],
      ["Медиана", "=МЕДИАНА(A4:A8)"]
    ]
- request: |
    ЗАДАЧА: Найди параметры линейной регрессии для данных из указанного диапазона, где в первой колонке указаны значения X, а во второй Y

    ДИАПАЗОН ЯЧЕЕК С ИСХОДНЫМИ ДАННЫМИ: A1:B8
  response: |
    [
      ["m (наклон)", "=НАКЛОН(B1:B8;A1:A8)"],
      ["b (сдвиг)", "=ОТРЕЗОК(B1:B8;A1:A8)"],
      ["σ (стандарт.ошибка)", "=СТОШYX(B1:B8;A1:A8)"]
    ]
- request: |
    ЗАДАЧА: Вычисли коэффициент корреляции между двумя переменными X и Y в указанном диапазоне

    ДИАПАЗОН ЯЧЕЕК С ИСХОДНЫМИ ДАННЫМИ: A2:B15
  response: |
    [
      ["Корреляция X-Y", "=КОРРЕЛ(A2:A15;B2:B15)"],
      ["Коэффициент детерминации", "=СТЕПЕНЬ(КОРРЕЛ(A2:A15;B2:B15);2)"],
      ["Ковариация", "=КОВАР(A2:A15;B2:B15)"]
    ]
- request: |
    ЗАДАЧА: Проведи дисперсионный анализ данных и вычисли основные показатели вариативности

    ДИАПАЗОН ЯЧЕЕК С ИСХОДНЫМИ ДАННЫМИ: B5:B20
  response: |
    [
      ["Дисперсия выборки", "=ДИСП.В(B5:B20)"],
      ["Дисперсия генеральной совокупности", "=ДИСП.Г(B5:B20)"],
      ["Стандартное отклонение", "=СТАНДОТКЛОН.В(B5:B20)"],
      ["Коэффициент вариации", "=СТАНДОТКЛОН.В(B5:B20)/СРЗНАЧ(B5:B20)*100"]
    ]
- request: |
    ЗАДАЧА: Определи квартили и процентили для анализа распределения данных

    ДИАПАЗОН ЯЧЕЕК С ИСХОДНЫМИ ДАННЫМИ: C1:C25
  response: |
    [
      ["1-й квартиль (25%)", "=КВАРТИЛЬ.ВКЛ(C1:C25;1)"],
      ["2-й квартиль (50%)", "=КВАРТИЛЬ.ВКЛ(C1:C25;2)"],
      ["3-й квартиль (75%)", "=КВАРТИЛЬ.ВКЛ(C1:C25;3)"],
      ["90-й процентиль", "=ПРОЦЕНТИЛЬ.ВКЛ(C1:C25;0,9)"],
      ["Межквартильный размах", "=КВАРТИЛЬ.ВКЛ(C1:C25;3)-КВАРТИЛЬ.ВКЛ(C1:C25;1)"]
    ]
- request: |
    ЗАДАЧА: Проанализируй тренд данных по времени, используя линейную регрессию для прогнозирования

    ДИАПАЗОН ЯЧЕЕК С ИСХОДНЫМИ ДАННЫМИ: A2:B20
  response: |
    [
      ["Наклон тренда", "=НАКЛОН(B2:B20;A2:A20)"],
      ["Y-пересечение", "=ОТРЕЗОК(B2:B20;A2:A20)"],
      ["R-квадрат", "=КВАДРОТКЛ(B2:B20;A2:A20)"],
      ["Прогноз на период 21", "=ПРЕДСКАЗ.ЛИНЕЙН(21;B2:B20;A2:A20)"],
      ["Стандартная ошибка", "=СТОШYX(B2:B20;A2:A20)"]
    ]
- request: |
    ЗАДАЧА: Проведи анализ выбросов в данных и определи аномальные значения

    ДИАПАЗОН ЯЧЕЕК С ИСХОДНЫМИ ДАННЫМИ: D3:D30
  response: |
    [
      ["Среднее значение", "=СРЗНАЧ(D3:D30)"],
      ["Стандартное отклонение", "=СТАНДОТКЛОН.В(D3:D30)"],
      ["Нижняя граница (μ-2σ)", "=СРЗНАЧ(D3:D30)-2*СТАНДОТКЛОН.В(D3:D30)"],
      ["Верхняя граница (μ+2σ)", "=СРЗНАЧ(D3:D30)+2*СТАНДОТКЛОН.В(D3:D30)"],
      ["Количество выбросов", "=СЧЁТЕСЛИМН(D3:D30;\"<\"&СРЗНАЧ(D3:D30)-2*СТАНДОТКЛОН.В(D3:D30))+СЧЁТЕСЛИМН(D3:D30;\">\"&СРЗНАЧ(D3:D30)+2*СТАНДОТКЛОН.В(D3:D30))"]
    ]
- request: |
    ЗАДАЧА: Проанализируй многомерные данные и создай корреляционную матрицу между всеми переменными

    ДИАПАЗОН ЯЧЕЕК С ИСХОДНЫМИ ДАННЫМИ: A6:D12
  response: |
    [
      ["", "Переменная A", "Переменная B", "Переменная C", "Переменная D"],
      ["Переменная A", "1", "=КОРРЕЛ(A6:A12;B6:B12)", "=КОРРЕЛ(A6:A12;C6:C12)", "=КОРРЕЛ(A6:A12;D6:D12)"],
      ["Переменная B", "=КОРРЕЛ(B6:B12;A6:A12)", "1", "=КОРРЕЛ(B6:B12;C6:C12)", "=КОРРЕЛ(B6:B12;D6:D12)"],
      ["Переменная C", "=КОРРЕЛ(C6:C12;A6:A12)", "=КОРРЕЛ(C6:C12;B6:B12)", "1", "=КОРРЕЛ(C6:C12;D6:D12)"],
      ["Переменная D", "=КОРРЕЛ(D6:D12;A6:A12)", "=КОРРЕЛ(D6:D12;B6:B12)", "=КОРРЕЛ(D6:D12;C6:C12)", "1"]
    ]
- request: |
    ЗАДАЧА: Проведи частотный анализ данных и определи распределение значений по интервалам

    ДИАПАЗОН ЯЧЕЕК С ИСХОДНЫМИ ДАННЫМИ: B1:B50
  response: |
    [
      ["Интервал", "Частота"],
      ["0-20", "=ЧАСТОТА(B1:B50;{20})"],
      ["21-40", "=ЧАСТОТА(B1:B50;{20;40})-ЧАСТОТА(B1:B50;{20})"],
      ["41-60", "=ЧАСТОТА(B1:B50;{20;40;60})-ЧАСТОТА(B1:B50;{20;40})"],
      ["61-80", "=ЧАСТОТА(B1:B50;{20;40;60;80})-ЧАСТОТА(B1:B50;{20;40;60})"],
      ["81-100", "=ЧАСТОТА(B1:B50;{20;40;60;80;100})-ЧАСТОТА(B1:B50;{20;40;60;80})"]
    ]
- request: |
    ЗАДАЧА: Проверь данные на нормальность распределения и вычисли показатели асимметрии и эксцесса

    ДИАПАЗОН ЯЧЕЕК С ИСХОДНЫМИ ДАННЫМИ: A1:A100
  response: |
    [
      ["Асимметрия", "=СКОС(A1:A100)"],
      ["Эксцесс", "=ЭКСЦЕСС(A1:A100)"],
      ["Тест Жарка-Бера (приблизительно)", "=СЧЁТ(A1:A100)/6*(СТЕПЕНЬ(СКОС(A1:A100);2)+(СТЕПЕНЬ(ЭКСЦЕСС(A1:A100);2)/4))"],
      ["Критическое значение (α=0,05)", "5,99"],
      ["Вывод", "=ЕСЛИ(СЧЁТ(A1:A100)/6*(СТЕПЕНЬ(СКОС(A1:A100);2)+(СТЕПЕНЬ(ЭКСЦЕСС(A1:A100);2)/4))>5,99;\"Не нормальное\";\"Нормальное\")"]
    ]

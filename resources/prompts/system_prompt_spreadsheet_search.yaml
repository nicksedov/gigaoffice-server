prompt: |
  Ты — виртуальный ассистент для поиска и фильтрации данных в электронных таблицах Р7-Офис.
  Ты получаешь данные в формате JSON, который включает структурированную информацию о таблице.
  Твоя задача - выполнить указанные пользователем операции по поиску и фильтрации данных.
  При работе с данными используй следующие операции:
  - Поиск по ключевым словам
  - Фильтрация по условиям (больше, меньше, равно, не равно, содержит, начинается с, заканчивается на)
  - Поиск по диапазонам значений
  - Поиск по шаблонам
  Всегда предоставляй ответ в формате расширенных данных таблицы, сохраняя структуру JSON.
  
examples:
- request: |
    ЗАДАЧА: Найди все строки, где сумма больше 10000
    
    РАСШИРЕННЫЕ ДАННЫЕ ТАБЛИЦЫ:
    {
      "metadata": {
        "version": "1.0"
      },
      "worksheet": {
        "name": "Продажи",
        "range": "A1:C7"
      },
      "styles": [
        {
          "id": "header_style",
          "background_color": "#4472C4",
          "font_color": "#FFFFFF",
          "font_weight": "bold",
          "font_size": "11"
        },
        {
          "id": "even_row_style",
          "background_color": "#F2F2F2",
          "font_weight": "normal",
          "font_style": "normal",
          "font_size": "11"
        },
        {
          "id": "odd_row_style",
          "background_color": "#FFFFFF",
          "font_weight": "normal",
          "font_style": "normal",
          "font_size": "11"
        }
      ],
      "data": {
        "header": {
          "values": ["Дата", "Продукт", "Сумма"],
          "style": "header_style"
        },
        "rows": [
          {
            "values": ["01.01.2024", "Товар A", 15000],
            "style": "even_row_style"
          },
          {
            "values": ["02.01.2024", "Товар B", 8000],
            "style": "odd_row_style"
          },
          {
            "values": ["03.01.2024", "Товар C", 12000],
            "style": "even_row_style"
          },
          {
            "values": ["04.01.2024", "Товар D", 9000],
            "style": "odd_row_style"
          },
          {
            "values": ["05.01.2024", "Товар E", 21000],
            "style": "even_row_style"
          },
          {
            "values": ["06.01.2024", "Товар F", 7500],
            "style": "odd_row_style"
          }
        ]
      },
      "columns": [
        {
          "index": 0,
          "format": "dd/mm/yyyy"
        },
        {
          "index": 1,
          "format": "General"
        },
        {
          "index": 2,
          "format": "#,##0.00"
        }
      ]
    }
  response: |
    {
      "metadata": {
        "version": "1.0"
      },
      "worksheet": {
        "name": "Продажи",
        "range": "A1:C4"
      },
      "styles": [
        {
          "id": "header_style",
          "background_color": "#4472C4",
          "font_color": "#FFFFFF",
          "font_weight": "bold",
          "font_size": "11"
        },
        {
          "id": "even_row_style",
          "background_color": "#F2F2F2",
          "font_weight": "normal",
          "font_style": "normal",
          "font_size": "11"
        },
        {
          "id": "odd_row_style",
          "background_color": "#FFFFFF",
          "font_weight": "normal",
          "font_style": "normal",
          "font_size": "11"
        }
      ],
      "data": {
        "header": {
          "values": ["Дата", "Продукт", "Сумма"],
          "style": "header_style"
        },
        "rows": [
          {
            "values": ["01.01.2024", "Товар A", 15000],
            "style": "even_row_style"
          },
          {
            "values": ["03.01.2024", "Товар C", 12000],
            "style": "odd_row_style"
          },
          {
            "values": ["05.01.2024", "Товар E", 21000],
            "style": "even_row_style"
          }
        ]
      },
      "columns": [
        {
          "index": 0,
          "format": "dd/mm/yyyy"
        },
        {
          "index": 1,
          "format": "General"
        },
        {
          "index": 2,
          "format": "#,##0.00"
        }
      ]
    }
- request: |
    ЗАДАЧА: Найди все продукты, названия которых содержат "Товар"
    
    РАСШИРЕННЫЕ ДАННЫЕ ТАБЛИЦЫ:
    {
      "metadata": {
        "version": "1.0"
      },
      "worksheet": {
        "name": "Каталог",
        "range": "A1:C10"
      },
      "styles": [
        {
          "id": "header_style",
          "background_color": "#4472C4",
          "font_color": "#FFFFFF",
          "font_weight": "bold",
          "font_size": "11"
        },
        {
          "id": "even_row_style",
          "background_color": "#F2F2F2",
          "font_weight": "normal",
          "font_style": "normal",
          "font_size": "11"
        },
        {
          "id": "odd_row_style",
          "background_color": "#FFFFFF",
          "font_weight": "normal",
          "font_style": "normal",
          "font_size": "11"
        }
      ],
      "data": {
        "header": {
          "values": ["Код", "Название", "Цена"],
          "style": "header_style"
        },
        "rows": [
          {
            "values": ["A001", "Товар A", 1500],
            "style": "even_row_style"
          },
          {
            "values": ["B002", "Услуга B", 2000],
            "style": "odd_row_style"
          },
          {
            "values": ["C003", "Товар C", 1200],
            "style": "even_row_style"
          },
          {
            "values": ["D004", "Материал D", 800],
            "style": "odd_row_style"
          },
          {
            "values": ["E005", "Товар E", 2100],
            "style": "even_row_style"
          },
          {
            "values": ["F006", "Работа F", 3000],
            "style": "odd_row_style"
          },
          {
            "values": ["G007", "Товар G", 950],
            "style": "even_row_style"
          }
        ]
      },
      "columns": [
        {
          "index": 0,
          "format": "General"
        },
        {
          "index": 1,
          "format": "General"
        },
        {
          "index": 2,
          "format": "#,##0.00"
        }
      ]
    }
  response: |
    {
      "metadata": {
        "version": "1.0"
      },
      "worksheet": {
        "name": "Каталог",
        "range": "A1:C5"
      },
      "styles": [
        {
          "id": "header_style",
          "background_color": "#4472C4",
          "font_color": "#FFFFFF",
          "font_weight": "bold",
          "font_size": "11"
        },
        {
          "id": "even_row_style",
          "background_color": "#F2F2F2",
          "font_weight": "normal",
          "font_style": "normal",
          "font_size": "11"
        },
        {
          "id": "odd_row_style",
          "background_color": "#FFFFFF",
          "font_weight": "normal",
          "font_style": "normal",
          "font_size": "11"
        }
      ],
      "data": {
        "header": {
          "values": ["Код", "Название", "Цена"],
          "style": "header_style"
        },
        "rows": [
          {
            "values": ["A001", "Товар A", 1500],
            "style": "even_row_style"
          },
          {
            "values": ["C003", "Товар C", 1200],
            "style": "odd_row_style"
          },
          {
            "values": ["E005", "Товар E", 2100],
            "style": "even_row_style"
          },
          {
            "values": ["G007", "Товар G", 950],
            "style": "odd_row_style"
          }
        ]
      },
      "columns": [
        {
          "index": 0,
          "format": "General"
        },
        {
          "index": 1,
          "format": "General"
        },
        {
          "index": 2,
          "format": "#,##0.00"
        }
      ]
    }
- request: |
    ЗАДАЧА: Найди все заказы в диапазоне дат с 01.01.2024 по 03.01.2024
    
    РАСШИРЕННЫЕ ДАННЫЕ ТАБЛИЦЫ:
    {
      "metadata": {
        "version": "1.0"
      },
      "worksheet": {
        "name": "Заказы",
        "range": "A1:D10"
      },
      "styles": [
        {
          "id": "header_style",
          "background_color": "#4472C4",
          "font_color": "#FFFFFF",
          "font_weight": "bold",
          "font_size": "11"
        },
        {
          "id": "even_row_style",
          "background_color": "#F2F2F2",
          "font_weight": "normal",
          "font_style": "normal",
          "font_size": "11"
        },
        {
          "id": "odd_row_style",
          "background_color": "#FFFFFF",
          "font_weight": "normal",
          "font_style": "normal",
          "font_size": "11"
        }
      ],
      "data": {
        "header": {
          "values": ["Номер", "Дата", "Клиент", "Сумма"],
          "style": "header_style"
        },
        "rows": [
          {
            "values": ["001", "30.12.2023", "Клиент A", 15000],
            "style": "even_row_style"
          },
          {
            "values": ["002", "01.01.2024", "Клиент B", 8000],
            "style": "odd_row_style"
          },
          {
            "values": ["003", "02.01.2024", "Клиент C", 12000],
            "style": "even_row_style"
          },
          {
            "values": ["004", "03.01.2024", "Клиент D", 9000],
            "style": "odd_row_style"
          },
          {
            "values": ["005", "04.01.2024", "Клиент E", 21000],
            "style": "even_row_style"
          },
          {
            "values": ["006", "05.01.2024", "Клиент F", 7500],
            "style": "odd_row_style"
          }
        ]
      },
      "columns": [
        {
          "index": 0,
          "format": "General"
        },
        {
          "index": 1,
          "format": "dd/mm/yyyy"
        },
        {
          "index": 2,
          "format": "General"
        },
        {
          "index": 3,
          "format": "#,##0.00"
        }
      ]
    }
  response: |
    {
      "metadata": {
        "version": "1.0"
      },
      "worksheet": {
        "name": "Заказы",
        "range": "A1:D4"
      },
      "styles": [
        {
          "id": "header_style",
          "background_color": "#4472C4",
          "font_color": "#FFFFFF",
          "font_weight": "bold",
          "font_size": "11"
        },
        {
          "id": "even_row_style",
          "background_color": "#F2F2F2",
          "font_weight": "normal",
          "font_style": "normal",
          "font_size": "11"
        },
        {
          "id": "odd_row_style",
          "background_color": "#FFFFFF",
          "font_weight": "normal",
          "font_style": "normal",
          "font_size": "11"
        }
      ],
      "data": {
        "header": {
          "values": ["Номер", "Дата", "Клиент", "Сумма"],
          "style": "header_style"
        },
        "rows": [
          {
            "values": ["002", "01.01.2024", "Клиент B", 8000],
            "style": "even_row_style"
          },
          {
            "values": ["003", "02.01.2024", "Клиент C", 12000],
            "style": "odd_row_style"
          },
          {
            "values": ["004", "03.01.2024", "Клиент D", 9000],
            "style": "even_row_style"
          }
        ]
      },
      "columns": [
        {
          "index": 0,
          "format": "General"
        },
        {
          "index": 1,
          "format": "dd/mm/yyyy"
        },
        {
          "index": 2,
          "format": "General"
        },
        {
          "index": 3,
          "format": "#,##0.00"
        }
      ]
    }
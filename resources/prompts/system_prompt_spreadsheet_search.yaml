prompt: |
  Ты — виртуальный ассистент для поиска и фильтрации данных в электронных таблицах Р7-Офис.
  Ты получаешь данные в формате JSON, который включает структурированную информацию о таблице.
  Твоя задача - выполнить указанные пользователем операции по поиску и фильтрации данных.
  
  Всегда предоставляй результат в формате расширенных данных таблицы, сохраняя структуру JSON.
  При обработке запросов пользователя следуй инструкциям и применяй соответствующие операции поиска и фильтрации.
  
  При работе с данными используй следующие операции:
  - Поиск по ключевым словам
  - Фильтрация по условиям (>, <, =, !=, содержит, начинается с, заканчивается на)
  - Поиск по диапазонам значений
  - Поиск по шаблонам

examples:
- request: |
    ЗАДАЧА: Найди все строки, где сумма больше 10000
    
    РАСШИРЕННЫЕ ДАННЫЕ ТАБЛИЦЫ:
    {
      "metadata": {
        "version": "1.0"
      },
      "worksheet": {
        "name": "Продажи",
        "range": "A1:C7"
      },
      "data": {
        "headers": {
          "values": ["Дата", "Продукт", "Сумма"]
        },
        "rows": [
          {
            "values": ["01.01.2024", "Товар A", 15000]
          },
          {
            "values": ["02.01.2024", "Товар B", 8000]
          },
          {
            "values": ["03.01.2024", "Товар C", 12000]
          },
          {
            "values": ["04.01.2024", "Товар D", 9000]
          },
          {
            "values": ["05.01.2024", "Товар E", 21000]
          },
          {
            "values": ["06.01.2024", "Товар F", 7500]
          }
        ]
      },
      "columns": [
        {
          "index": 0,
          "name": "Дата",
          "type": "date",
          "format": "ДД.ММ.ГГГГ"
        },
        {
          "index": 1,
          "name": "Продукт",
          "type": "string",
          "format": "text"
        },
        {
          "index": 2,
          "name": "Сумма",
          "type": "number",
          "format": "#,##0.00"
        }
      ]
    }
  response: |
    {
      "metadata": {
        "version": "1.0"
      },
      "worksheet": {
        "name": "Продажи",
        "range": "A1:C4"
      },
      "data": {
        "headers": {
          "values": ["Дата", "Продукт", "Сумма"]
        },
        "rows": [
          {
            "values": ["01.01.2024", "Товар A", 15000]
          },
          {
            "values": ["03.01.2024", "Товар C", 12000]
          },
          {
            "values": ["05.01.2024", "Товар E", 21000]
          }
        ]
      },
      "columns": [
        {
          "index": 0,
          "name": "Дата",
          "type": "date",
          "format": "ДД.ММ.ГГГГ"
        },
        {
          "index": 1,
          "name": "Продукт",
          "type": "string",
          "format": "text"
        },
        {
          "index": 2,
          "name": "Сумма",
          "type": "number",
          "format": "#,##0.00"
        }
      ]
    }
- request: |
    ЗАДАЧА: Найди все продукты, названия которых содержат "Товар"
    
    РАСШИРЕННЫЕ ДАННЫЕ ТАБЛИЦЫ:
    {
      "metadata": {
        "version": "1.0"
      },
      "worksheet": {
        "name": "Каталог",
        "range": "A1:C10"
      },
      "data": {
        "headers": {
          "values": ["Код", "Название", "Цена"]
        },
        "rows": [
          {
            "values": ["A001", "Товар A", 1500]
          },
          {
            "values": ["B002", "Услуга B", 2000]
          },
          {
            "values": ["C003", "Товар C", 1200]
          },
          {
            "values": ["D004", "Материал D", 800]
          },
          {
            "values": ["E005", "Товар E", 2100]
          },
          {
            "values": ["F006", "Работа F", 3000]
          },
          {
            "values": ["G007", "Товар G", 950]
          }
        ]
      },
      "columns": [
        {
          "index": 0,
          "name": "Код",
          "type": "string",
          "format": "text"
        },
        {
          "index": 1,
          "name": "Название",
          "type": "string",
          "format": "text"
        },
        {
          "index": 2,
          "name": "Цена",
          "type": "number",
          "format": "#,##0.00"
        }
      ]
    }
  response: |
    {
      "metadata": {
        "version": "1.0"
      },
      "worksheet": {
        "name": "Каталог",
        "range": "A1:C5"
      },
      "data": {
        "headers": {
          "values": ["Код", "Название", "Цена"]
        },
        "rows": [
          {
            "values": ["A001", "Товар A", 1500]
          },
          {
            "values": ["C003", "Товар C", 1200]
          },
          {
            "values": ["E005", "Товар E", 2100]
          },
          {
            "values": ["G007", "Товар G", 950]
          }
        ]
      },
      "columns": [
        {
          "index": 0,
          "name": "Код",
          "type": "string",
          "format": "text"
        },
        {
          "index": 1,
          "name": "Название",
          "type": "string",
          "format": "text"
        },
        {
          "index": 2,
          "name": "Цена",
          "type": "number",
          "format": "#,##0.00"
        }
      ]
    }
- request: |
    ЗАДАЧА: Найди все заказы в диапазоне дат с 01.01.2024 по 03.01.2024
    
    РАСШИРЕННЫЕ ДАННЫЕ ТАБЛИЦЫ:
    {
      "metadata": {
        "version": "1.0"
      },
      "worksheet": {
        "name": "Заказы",
        "range": "A1:D10"
      },
      "data": {
        "headers": {
          "values": ["Номер", "Дата", "Клиент", "Сумма"]
        },
        "rows": [
          {
            "values": ["001", "30.12.2023", "Клиент A", 15000]
          },
          {
            "values": ["002", "01.01.2024", "Клиент B", 8000]
          },
          {
            "values": ["003", "02.01.2024", "Клиент C", 12000]
          },
          {
            "values": ["004", "03.01.2024", "Клиент D", 9000]
          },
          {
            "values": ["005", "04.01.2024", "Клиент E", 21000]
          },
          {
            "values": ["006", "05.01.2024", "Клиент F", 7500]
          }
        ]
      },
      "columns": [
        {
          "index": 0,
          "name": "Номер",
          "type": "string",
          "format": "text"
        },
        {
          "index": 1,
          "name": "Дата",
          "type": "date",
          "format": "ДД.ММ.ГГГГ"
        },
        {
          "index": 2,
          "name": "Клиент",
          "type": "string",
          "format": "text"
        },
        {
          "index": 3,
          "name": "Сумма",
          "type": "number",
          "format": "#,##0.00"
        }
      ]
    }
  response: |
    {
      "metadata": {
        "version": "1.0"
      },
      "worksheet": {
        "name": "Заказы",
        "range": "A1:D4"
      },
      "data": {
        "headers": {
          "values": ["Номер", "Дата", "Клиент", "Сумма"]
        },
        "rows": [
          {
            "values": ["002", "01.01.2024", "Клиент B", 8000]
          },
          {
            "values": ["003", "02.01.2024", "Клиент C", 12000]
          },
          {
            "values": ["004", "03.01.2024", "Клиент D", 9000]
          }
        ]
      },
      "columns": [
        {
          "index": 0,
          "name": "Номер",
          "type": "string",
          "format": "text"
        },
        {
          "index": 1,
          "name": "Дата",
          "type": "date",
          "format": "ДД.ММ.ГГГГ"
        },
        {
          "index": 2,
          "name": "Клиент",
          "type": "string",
          "format": "text"
        },
        {
          "index": 3,
          "name": "Сумма",
          "type": "number",
          "format": "#,##0.00"
        }
      ]
    }
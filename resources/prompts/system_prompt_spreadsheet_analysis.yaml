prompt: |
  Ты — виртуальный ассистент для статистического анализа данных в электронных таблицах Р7-Офис.
  Ты получаешь данные в формате JSON, который включает структурированную информацию о таблице.
  Твоя задача - выполнить указанные пользователем аналитические операции.
  
  Всегда предоставляй результат в формате расширенных данных таблицы, сохраняя структуру JSON.
  При обработке запросов пользователя следуй инструкциям и применяй соответствующие аналитические функции.

examples:
- request: |
    ЗАДАЧА: Найди минимальное, максимальное, среднее и медианное значения в столбце "Цена"
    
    РАСШИРЕННЫЕ ДАННЫЕ ТАБЛИЦЫ:
    {
      "metadata": {
        "version": "1.0"
      },
      "worksheet": {
        "name": "Продажи",
        "range": "A1:C6"
      },
      "data": {
        "header": {
          "values": ["Продукт", "Количество", "Цена"]
        },
        "rows": [
          {
            "values": ["Товар A", 100, 1500]
          },
          {
            "values": ["Товар B", 250, 800]
          },
          {
            "values": ["Товар C", 180, 1200]
          },
          {
            "values": ["Товар D", 90, 2100]
          },
          {
            "values": ["Товар E", 320, 650]
          }
        ]
      },
      "columns": [
        {
          "index": 0,
          "name": "Продукт",
          "type": "string",
          "format": "text"
        },
        {
          "index": 1,
          "name": "Количество",
          "type": "number",
          "format": "#,##0"
        },
        {
          "index": 2,
          "name": "Цена",
          "type": "number",
          "format": "#,##0.00"
        }
      ]
    }
  response: |
    {
      "metadata": {
        "version": "1.0"
      },
      "worksheet": {
        "name": "Продажи",
        "range": "A1:C6"
      },
      "data": {
        "header": {
          "values": []
        },
        "rows": [
          {
            "values": ["Минимальное:", "=МИН(C2:C6)"]
          },
          {
            "values": ["Максимальное:", "=МАКС(C2:C6)"]
          },
          {
            "values": ["Среднее:", "=CРЗНАЧ(C2:C6)"]
          },
          {
            "values": ["Медиана:", "=МЕДИАНА(C2:C6)"]
          }
        ]
      }
    }

- request: |
    ЗАДАЧА: посчитай среднюю зарплату сотрудников
    
    РАСШИРЕННЫЕ ДАННЫЕ ТАБЛИЦЫ:
    {
      "metadata": {
        "version": "1.0"
      },
      "worksheet": {
        "name": "Сотрудники",
        "range": "A1:H8"
      },
      "data": {
        "header": {
          "values": ["Имя", "Фамилия", "Должность", "Отдел", "Зарплата", "Дата приема", "Возраст", "Образование", "Стаж"]
        },
        "rows": [
          {
            "values": ["Анна", "Иванова", "Менеджер", "Продажи", 85000, "01.03.2018", 32, "Высшее", 7]
          },
          {
            "values": ["Петр", "Сидоров", "Разработчик", "IT", 120000, "15.06.2019", 28, "Высшее", 6]
          },
          {
            "values": ["Мария", "Петрова", "Аналитик", "Финансы", 95000, "10.01.2020", 35, "Высшее", 5]
          },
          {
            "values": ["Сергей", "Козлов", "Дизайнер", "Маркетинг", 75000, "22.09.2021", 26, "Среднее специальное", 4]
          },
          {
            "values": ["Елена", "Смирнова", "Бухгалтер", "Финансы", 65000, "05.11.2017", 45, "Высшее", 8]
          },
          {
            "values": ["Александр", "Волков", "Руководитель", "IT", 150000, "12.02.2016", 38, "Высшее", 9]
          },
          {
            "values": ["Ольга", "Николаева", "Секретарь", "Администрация", 45000, "18.04.2022", 24, "Среднее", 3]
          }
        ]
      },
      "columns": [
        {
          "index": 0,
          "name": "Имя",
          "type": "string",
          "format": "text"
        },
        {
          "index": 1,
          "name": "Фамилия",
          "type": "string",
          "format": "text"
        },
        {
          "index": 2,
          "name": "Должность",
          "type": "string",
          "format": "text"
        },
        {
          "index": 3,
          "name": "Отдел",
          "type": "string",
          "format": "text"
        },
        {
          "index": 4,
          "name": "Зарплата",
          "type": "number",
          "format": "#,##0"
        },
        {
          "index": 5,
          "name": "Дата приема",
          "type": "date",
          "format": "dd.mm.yyyy"
        },
        {
          "index": 6,
          "name": "Возраст",
          "type": "number",
          "format": "#0"
        },
        {
          "index": 7,
          "name": "Образование",
          "type": "string",
          "format": "text"
        },
        {
          "index": 8,
          "name": "Стаж",
          "type": "number",
          "format": "#0"
        }
      ]
    }
  response: |
    {
      "metadata": {
        "version": "1.0"
      },
      "worksheet": {
        "name": "Сотрудники",
        "range": "A1:H8"
      },
      "data": {
        "header": {
          "values": []
        },
        "rows": [
          {
            "values": ["Средняя зарплата сотрудников:", "=СРЗНАЧ(E2:E8)"]
          }
        ]
      }
    }

- request: |
    ЗАДАЧА: проанализируй доходность по месяцам и найди месяц с максимальной прибылью
    
    РАСШИРЕННЫЕ ДАННЫЕ ТАБЛИЦЫ:
    {
      "metadata": {
        "version": "1.0"
      },
      "worksheet": {
        "name": "Финансовый отчет",
        "range": "A1:D13"
      },
      "data": {
        "header": {
          "values": ["Месяц", "Доходы", "Расходы", "Прибыль"]
        },
        "rows": [
          {
            "values": ["Январь", 250000, 180000, 70000]
          },
          {
            "values": ["Февраль", 280000, 195000, 85000]
          },
          {
            "values": ["Март", 320000, 210000, 110000]
          },
          {
            "values": ["Апрель", 295000, 205000, 90000]
          },
          {
            "values": ["Май", 380000, 225000, 155000]
          },
          {
            "values": ["Июнь", 410000, 240000, 170000]
          },
          {
            "values": ["Июль", 450000, 260000, 190000]
          },
          {
            "values": ["Август", 425000, 250000, 175000]
          },
          {
            "values": ["Сентябрь", 395000, 235000, 160000]
          },
          {
            "values": ["Октябрь", 365000, 220000, 145000]
          },
          {
            "values": ["Ноябрь", 340000, 215000, 125000]
          },
          {
            "values": ["Декабрь", 475000, 285000, 190000]
          }
        ]
      },
      "columns": [
        {
          "index": 0,
          "name": "Месяц",
          "type": "string",
          "format": "text"
        },
        {
          "index": 1,
          "name": "Доходы",
          "type": "number",
          "format": "#,##0"
        },
        {
          "index": 2,
          "name": "Расходы",
          "type": "number",
          "format": "#,##0"
        },
        {
          "index": 3,
          "name": "Прибыль",
          "type": "number",
          "format": "#,##0"
        }
      ]
    }
  response: |
    {
      "metadata": {
        "version": "1.0"
      },
      "worksheet": {
        "name": "Финансовый отчет",
        "range": "A1:D13"
      },
      "data": {
        "header": {
          "values": []
        },
        "rows": [
          {
            "values": ["Общая прибыль за год:", "=СУММ(D2:D13)"]
          },
          {
            "values": ["Средняя прибыль по месяцам:", "=СРЗНАЧ(D2:D13)"]
          },
          {
            "values": ["Максимальная прибыль:", "=МАКС(D2:D13)"]
          },
          {
            "values": ["Месяц с максимальной прибылью:", "=ИНДЕКС(A2:A13;ПОИСКПОЗ(МАКС(D2:D13);D2:D13;0))"]
          },
          {
            "values": ["Минимальная прибыль:", "=МИН(D2:D13)"]
          },
          {
            "values": ["Месяц с минимальной прибылью:", "=ИНДЕКС(A2:A13;ПОИСКПОЗ(МИН(D2:D13);D2:D13;0))"]
          }
        ]
      }
    }
prompt: |
  Ты — виртуальный ассистент для статистического анализа данных в электронных таблицах Р7-Офис.
  Ты получаешь данные в формате JSON, который включает структурированную информацию о таблице.
  Твоя задача - выполнить указанные пользователем аналитические операции.
  
  Всегда предоставляй результат в формате расширенных данных таблицы, сохраняя структуру JSON.
  При обработке запросов пользователя следуй инструкциям и применяй соответствующие аналитические функции.
  
  При работе с данными используй следующие аналитические функции:
  - SUM: сумма значений
  - AVERAGE: среднее значение
  - MIN: минимальное значение
  - MAX: максимальное значение
  - COUNT: количество значений
  - MEDIAN: медиана
  - STDEV: стандартное отклонение

examples:
- request: |
    ЗАДАЧА: Найди минимальное, максимальное, среднее и медианное значения в столбце "Цена"
    
    РАСШИРЕННЫЕ ДАННЫЕ ТАБЛИЦЫ:
    {
      "metadata": {
        "version": "1.0"
      },
      "worksheet": {
        "name": "Продажи",
        "range": "A1:C6"
      },
      "data": {
        "headers": {
          "values": ["Продукт", "Количество", "Цена"]
        },
        "rows": [
          {
            "values": ["Товар A", 100, 1500]
          },
          {
            "values": ["Товар B", 250, 800]
          },
          {
            "values": ["Товар C", 180, 1200]
          },
          {
            "values": ["Товар D", 90, 2100]
          },
          {
            "values": ["Товар E", 320, 650]
          }
        ]
      },
      "columns": [
        {
          "index": 0,
          "name": "Продукт",
          "type": "string",
          "format": "text"
        },
        {
          "index": 1,
          "name": "Количество",
          "type": "number",
          "format": "#,##0"
        },
        {
          "index": 2,
          "name": "Цена",
          "type": "number",
          "format": "#,##0.00"
        }
      ]
    }
  response: |
    {
      "metadata": {
        "version": "1.0"
      },
      "worksheet": {
        "name": "Продажи",
        "range": "A1:C6"
      },
      "data": {
        "headers": {
          "values": ["Продукт", "Количество", "Цена"]
        },
        "rows": [
          {
            "values": ["Товар A", 100, 1500]
          },
          {
            "values": ["Товар B", 250, 800]
          },
          {
            "values": ["Товар C", 180, 1200]
          },
          {
            "values": ["Товар D", 90, 2100]
          },
          {
            "values": ["Товар E", 320, 650]
          }
        ]
      },
      "columns": [
        {
          "index": 0,
          "name": "Продукт",
          "type": "string",
          "format": "text"
        },
        {
          "index": 1,
          "name": "Количество",
          "type": "number",
          "format": "#,##0"
        },
        {
          "index": 2,
          "name": "Цена",
          "type": "number",
          "format": "#,##0.00",
          "statistics": {
            "min": 650,
            "max": 2100,
            "average": 1250,
            "median": 1200
          }
        }
      ]
    }
- request: |
    ЗАДАЧА: Вычисли общую сумму продаж и среднюю цену товаров
    
    РАСШИРЕННЫЕ ДАННЫЕ ТАБЛИЦЫ:
    {
      "metadata": {
        "version": "1.0"
      },
      "worksheet": {
        "name": "Финансы",
        "range": "A1:D5"
      },
      "data": {
        "headers": {
          "values": ["Дата", "Продукт", "Количество", "Цена"]
        },
        "rows": [
          {
            "values": ["01.01.2024", "Товар A", 10, 1500]
          },
          {
            "values": ["02.01.2024", "Товар B", 5, 800]
          },
          {
            "values": ["03.01.2024", "Товар C", 8, 1200]
          },
          {
            "values": ["04.01.2024", "Товар D", 3, 2100]
          }
        ]
      },
      "columns": [
        {
          "index": 0,
          "name": "Дата",
          "type": "date",
          "format": "ДД.ММ.ГГГГ"
        },
        {
          "index": 1,
          "name": "Продукт",
          "type": "string",
          "format": "text"
        },
        {
          "index": 2,
          "name": "Количество",
          "type": "number",
          "format": "#,##0"
        },
        {
          "index": 3,
          "name": "Цена",
          "type": "number",
          "format": "#,##0.00"
        }
      ]
    }
  response: |
    {
      "metadata": {
        "version": "1.0"
      },
      "worksheet": {
        "name": "Финансы",
        "range": "A1:D6"
      },
      "data": {
        "headers": {
          "values": ["Дата", "Продукт", "Количество", "Цена"]
        },
        "rows": [
          {
            "values": ["01.01.2024", "Товар A", 10, 1500]
          },
          {
            "values": ["02.01.2024", "Товар B", 5, 800]
          },
          {
            "values": ["03.01.2024", "Товар C", 8, 1200]
          },
          {
            "values": ["04.01.2024", "Товар D", 3, 2100]
          },
          {
            "values": ["", "", "Итого:", 57400],
            "style": {
              "font_weight": "bold"
            }
          }
        ]
      },
      "columns": [
        {
          "index": 0,
          "name": "Дата",
          "type": "date",
          "format": "ДД.ММ.ГГГГ"
        },
        {
          "index": 1,
          "name": "Продукт",
          "type": "string",
          "format": "text"
        },
        {
          "index": 2,
          "name": "Количество",
          "type": "number",
          "format": "#,##0"
        },
        {
          "index": 3,
          "name": "Цена",
          "type": "number",
          "format": "#,##0.00",
          "statistics": {
            "sum": 57400,
            "average": 14350
          }
        }
      ]
    }
- request: |
    ЗАДАЧА: Проанализируй данные продаж по месяцам и определи тренд
    
    РАСШИРЕННЫЕ ДАННЫЕ ТАБЛИЦЫ:
    {
      "metadata": {
        "version": "1.0"
      },
      "worksheet": {
        "name": "Анализ продаж",
        "range": "A1:B13"
      },
      "data": {
        "headers": {
          "values": ["Месяц", "Продажи"]
        },
        "rows": [
          {
            "values": ["Январь", 150000]
          },
          {
            "values": ["Февраль", 142000]
          },
          {
            "values": ["Март", 165000]
          },
          {
            "values": ["Апрель", 158000]
          },
          {
            "values": ["Май", 172000]
          },
          {
            "values": ["Июнь", 168000]
          },
          {
            "values": ["Июль", 185000]
          },
          {
            "values": ["Август", 192000]
          },
          {
            "values": ["Сентябрь", 188000]
          },
          {
            "values": ["Октябрь", 201000]
          },
          {
            "values": ["Ноябрь", 195000]
          },
          {
            "values": ["Декабрь", 210000]
          }
        ]
      },
      "columns": [
        {
          "index": 0,
          "name": "Месяц",
          "type": "string",
          "format": "text"
        },
        {
          "index": 1,
          "name": "Продажи",
          "type": "number",
          "format": "#,##0.00"
        }
      ]
    }
  response: |
    {
      "metadata": {
        "version": "1.0"
      },
      "worksheet": {
        "name": "Анализ продаж",
        "range": "A1:C14"
      },
      "data": {
        "headers": {
          "values": ["Месяц", "Продажи", "Тренд"]
        },
        "rows": [
          {
            "values": ["Январь", 150000, ""]
          },
          {
            "values": ["Февраль", 142000, "Снижение"]
          },
          {
            "values": ["Март", 165000, "Рост"]
          },
          {
            "values": ["Апрель", 158000, "Снижение"]
          },
          {
            "values": ["Май", 172000, "Рост"]
          },
          {
            "values": ["Июнь", 168000, "Снижение"]
          },
          {
            "values": ["Июль", 185000, "Рост"]
          },
          {
            "values": ["Август", 192000, "Рост"]
          },
          {
            "values": ["Сентябрь", 188000, "Снижение"]
          },
          {
            "values": ["Октябрь", 201000, "Рост"]
          },
          {
            "values": ["Ноябрь", 195000, "Снижение"]
          },
          {
            "values": ["Декабрь", 210000, "Рост"]
          },
          {
            "values": ["", "Итого:", "Рост"],
            "style": {
              "font_weight": "bold"
            }
          }
        ]
      },
      "columns": [
        {
          "index": 0,
          "name": "Месяц",
          "type": "string",
          "format": "text"
        },
        {
          "index": 1,
          "name": "Продажи",
          "type": "number",
          "format": "#,##0.00",
          "statistics": {
            "min": 142000,
            "max": 210000,
            "average": 176916.67,
            "trend": "positive"
          }
        },
        {
          "index": 2,
          "name": "Тренд",
          "type": "string",
          "format": "text"
        }
      ]
    }
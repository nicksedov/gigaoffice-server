prompt: |
  Ты — виртуальный ассистент для работы с расширенными данными электронных таблиц Р7-Офис.
  Ты получаешь данные в формате JSON, который включает структурированную информацию о таблице, включая:
  - Метаданные таблицы
  - Информацию о листе (название, диапазон, опции)
  - Данные (заголовки и строки)
  - Определения колонок с типами и форматами
  - Стили для ячеек, заголовков и строк
  - Формулы для вычислений
  - Определения диаграмм
  
  Всегда предоставляй результат в формате расширенных данных таблицы, сохраняя структуру JSON.
  При обработке запросов пользователя следуй инструкциям и применяй соответствующие изменения к структуре данных.
  При генерации формул используй функции, применимые в Р7-Офис (аналогично Excel).
  При создании диаграмм указывай корректные диапазоны данных.
  Соблюдай формат дат и числовых значений, указанный в определениях колонок.
  При добавлении новых строк или колонок следуй существующей структуре данных.
examples:
- request: |
    ЗАДАЧА: Добавь новую колонку "Итого" с формулой суммы по строкам
    
    РАСШИРЕННЫЕ ДАННЫЕ ТАБЛИЦЫ:
    {
      "metadata": {
        "version": "1.0",
        "format": "enhanced-spreadsheet-data"
      },
      "worksheet": {
        "name": "Продажи",
        "range": "A1",
        "options": {
          "auto_resize_columns": true,
          "freeze_headers": true
        }
      },
      "data": {
        "headers": {
          "values": ["Продукт", "Q1", "Q2", "Q3", "Q4"]
        },
        "rows": [
          {
            "values": ["Продукт A", 100, 120, 110, 130]
          },
          {
            "values": ["Продукт B", 80, 90, 95, 100]
          }
        ]
      },
      "columns": [
        {
          "index": 0,
          "name": "Продукт",
          "type": "string",
          "format": "text"
        },
        {
          "index": 1,
          "name": "Q1",
          "type": "number",
          "format": "#,##0"
        },
        {
          "index": 2,
          "name": "Q2",
          "type": "number",
          "format": "#,##0"
        },
        {
          "index": 3,
          "name": "Q3",
          "type": "number",
          "format": "#,##0"
        },
        {
          "index": 4,
          "name": "Q4",
          "type": "number",
          "format": "#,##0"
        }
      ]
    }
  response: |
    {
      "metadata": {
        "version": "1.0",
        "format": "enhanced-spreadsheet-data"
      },
      "worksheet": {
        "name": "Продажи",
        "range": "A1",
        "options": {
          "auto_resize_columns": true,
          "freeze_headers": true
        }
      },
      "data": {
        "headers": {
          "values": ["Продукт", "Q1", "Q2", "Q3", "Q4", "Итого"]
        },
        "rows": [
          {
            "values": ["Продукт A", 100, 120, 110, 130, "=SUM(B2:E2)"]
          },
          {
            "values": ["Продукт B", 80, 90, 95, 100, "=SUM(B3:E3)"]
          }
        ]
      },
      "columns": [
        {
          "index": 0,
          "name": "Продукт",
          "type": "string",
          "format": "text"
        },
        {
          "index": 1,
          "name": "Q1",
          "type": "number",
          "format": "#,##0"
        },
        {
          "index": 2,
          "name": "Q2",
          "type": "number",
          "format": "#,##0"
        },
        {
          "index": 3,
          "name": "Q3",
          "type": "number",
          "format": "#,##0"
        },
        {
          "index": 4,
          "name": "Q4",
          "type": "number",
          "format": "#,##0"
        },
        {
          "index": 5,
          "name": "Итого",
          "type": "number",
          "format": "#,##0"
        }
      ],
      "formulas": [
        {
          "cell": "F2",
          "formula": "=SUM(B2:E2)",
          "description": "Сумма продаж по продукту A"
        },
        {
          "cell": "F3",
          "formula": "=SUM(B3:E3)",
          "description": "Сумма продаж по продукту B"
        }
      ]
    }
- request: |
    ЗАДАЧА: Создай столбчатую диаграмму для сравнения продаж по кварталам
    
    РАСШИРЕННЫЕ ДАННЫЕ ТАБЛИЦЫ:
    {
      "metadata": {
        "version": "1.0",
        "format": "enhanced-spreadsheet-data"
      },
      "worksheet": {
        "name": "Продажи",
        "range": "A1"
      },
      "data": {
        "headers": {
          "values": ["Продукт", "Q1", "Q2", "Q3", "Q4"]
        },
        "rows": [
          {
            "values": ["Продукт A", 100, 120, 110, 130]
          },
          {
            "values": ["Продукт B", 80, 90, 95, 100]
          }
        ]
      }
    }
  response: |
    {
      "metadata": {
        "version": "1.0",
        "format": "enhanced-spreadsheet-data"
      },
      "worksheet": {
        "name": "Продажи",
        "range": "A1"
      },
      "data": {
        "headers": {
          "values": ["Продукт", "Q1", "Q2", "Q3", "Q4"]
        },
        "rows": [
          {
            "values": ["Продукт A", 100, 120, 110, 130]
          },
          {
            "values": ["Продукт B", 80, 90, 95, 100]
          }
        ]
      },
      "charts": [
        {
          "type": "column",
          "title": "Сравнение продаж по кварталам",
          "range": "A1:E3",
          "position": {
            "top": 100,
            "left": 300,
            "width": 400,
            "height": 300
          },
          "style": {
            "color_scheme": "office"
          }
        }
      ]
    }
- request: |
    ЗАДАЧА: Примени чередующиеся цвета строк для улучшения читаемости
    
    РАСШИРЕННЫЕ ДАННЫЕ ТАБЛИЦЫ:
    {
      "metadata": {
        "version": "1.0",
        "format": "enhanced-spreadsheet-data"
      },
      "worksheet": {
        "name": "Отчет",
        "range": "A1"
      },
      "data": {
        "headers": {
          "values": ["Дата", "Описание", "Сумма"]
        },
        "rows": [
          {
            "values": ["01.01.2024", "Продажа товара", 15000]
          },
          {
            "values": ["02.01.2024", "Покупка материалов", -8000]
          },
          {
            "values": ["03.01.2024", "Оплата услуг", -3000]
          }
        ]
      }
    }
  response: |
    {
      "metadata": {
        "version": "1.0",
        "format": "enhanced-spreadsheet-data"
      },
      "worksheet": {
        "name": "Отчет",
        "range": "A1"
      },
      "data": {
        "headers": {
          "values": ["Дата", "Описание", "Сумма"]
        },
        "rows": [
          {
            "values": ["01.01.2024", "Продажа товара", 15000]
          },
          {
            "values": ["02.01.2024", "Покупка материалов", -8000]
          },
          {
            "values": ["03.01.2024", "Оплата услуг", -3000]
          }
        ]
      },
      "styles": {
        "alternating_rows": {
          "even": {
            "background_color": "#F2F2F2"
          },
          "odd": {
            "background_color": "#FFFFFF"
          }
        }
      }
    }
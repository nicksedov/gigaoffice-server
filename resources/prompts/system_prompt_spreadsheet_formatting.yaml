prompt: |
  Ты — виртуальный ассистент для форматирования данных в электронных таблицах Р7-Офис.
  Ты получаешь данные в формате JSON, который включает структурированную информацию о таблице.
  Твоя задача - применить указанные пользователем изменения форматирования к таблице.
  
  Всегда предоставляй результат в формате расширенных данных таблицы, сохраняя структуру JSON.
  При обработке запросов пользователя следуй инструкциям и применяй соответствующие изменения к стилям.
  
  При работе со стилями используй следующие параметры:
  - background_color: цвет фона в формате hex
  - font_color: цвет шрифта в формате hex
  - font_weight: насыщенность шрифта (normal, bold)
  - font_style: стиль шрифта (normal, italic)
  - font_size: размер шрифта в пунктах
  - horizontal_alignment: горизонтальное выравнивание (left, center, right)
  - vertical_alignment: вертикальное выравнивание (top, middle, bottom)

examples:
- request: |
    ЗАДАЧА: Примени чередующиеся цвета строк для улучшения читаемости
    
    РАСШИРЕННЫЕ ДАННЫЕ ТАБЛИЦЫ:
    {
      "metadata": {
        "version": "1.0"
      },
      "worksheet": {
        "name": "Отчет",
        "range": "A1:C4"
      },
      "data": {
        "header": {
          "values": ["Дата", "Описание", "Сумма"]
        },
        "rows": [
          {
            "values": ["01.01.2024", "Продажа товара", 15000]
          },
          {
            "values": ["02.01.2024", "Покупка материалов", -8000]
          },
          {
            "values": ["03.01.2024", "Оплата услуг", -3000]
          }
        ]
      }
    }
  response: |
    {
      "metadata": {
        "version": "1.0"
      },
      "worksheet": {
        "name": "Отчет",
        "range": "A1:C4"
      },
      "data": {
        "header": {
          "values": ["Дата", "Описание", "Сумма"],
          "style": {
            "background_color": "#4472C4",
            "font_color": "#FFFFFF",
            "font_weight": "bold"
          }
        },
        "rows": [
          {
            "values": ["01.01.2024", "Продажа товара", 15000],
            "style": {
              "background_color": "#F2F2F2"
            }
          },
          {
            "values": ["02.01.2024", "Покупка материалов", -8000],
            "style": {
              "background_color": "#FFFFFF"
            }
          },
          {
            "values": ["03.01.2024", "Оплата услуг", -3000],
            "style": {
              "background_color": "#F2F2F2"
            }
          }
        ]
      }
    }
- request: |
    ЗАДАЧА: Выдели отрицательные значения в столбце "Сумма" красным цветом
    
    РАСШИРЕННЫЕ ДАННЫЕ ТАБЛИЦЫ:
    {
      "metadata": {
        "version": "1.0"
      },
      "worksheet": {
        "name": "Финансы",
        "range": "A1:C5"
      },
      "data": {
        "header": {
          "values": ["Дата", "Описание", "Сумма"]
        },
        "rows": [
          {
            "values": ["01.01.2024", "Продажа", 15000]
          },
          {
            "values": ["02.01.2024", "Покупка", -8000]
          },
          {
            "values": ["03.01.2024", "Оплата", -3000]
          },
          {
            "values": ["04.01.2024", "Возврат", 2500]
          }
        ]
      },
      "columns": [
        {
          "index": 0,
          "name": "Дата",
          "type": "date",
          "format": "ДД.ММ.ГГГГ"
        },
        {
          "index": 1,
          "name": "Описание",
          "type": "string",
          "format": "text"
        },
        {
          "index": 2,
          "name": "Сумма",
          "type": "number",
          "format": "#,##0.00"
        }
      ]
    }
  response: |
    {
      "metadata": {
        "version": "1.0"
      },
      "worksheet": {
        "name": "Финансы",
        "range": "A1:C5"
      },
      "data": {
        "header": {
          "values": ["Дата", "Описание", "Сумма"]
        },
        "rows": [
          {
            "values": ["01.01.2024", "Продажа", 15000]
          },
          {
            "values": ["02.01.2024", "Покупка", -8000],
            "style": {
              "font_color": "#FF0000"
            }
          },
          {
            "values": ["03.01.2024", "Оплата", -3000],
            "style": {
              "font_color": "#FF0000"
            }
          },
          {
            "values": ["04.01.2024", "Возврат", 2500]
          }
        ]
      },
      "columns": [
        {
          "index": 0,
          "name": "Дата",
          "type": "date",
          "format": "ДД.ММ.ГГГГ"
        },
        {
          "index": 1,
          "name": "Описание",
          "type": "string",
          "format": "text"
        },
        {
          "index": 2,
          "name": "Сумма",
          "type": "number",
          "format": "#,##0.00"
        }
      ]
    }
- request: |
    ЗАДАЧА: Сделай заголовки жирным шрифтом и выровняй числовые значения по правому краю
    
    РАСШИРЕННЫЕ ДАННЫЕ ТАБЛИЦЫ:
    {
      "metadata": {
        "version": "1.0"
      },
      "worksheet": {
        "name": "Продажи",
        "range": "A1:C4"
      },
      "data": {
        "header": {
          "values": ["Продукт", "Количество", "Цена"]
        },
        "rows": [
          {
            "values": ["Товар A", 100, 1500]
          },
          {
            "values": ["Товар B", 250, 800]
          }
        ]
      },
      "columns": [
        {
          "index": 0,
          "name": "Продукт",
          "type": "string",
          "format": "text"
        },
        {
          "index": 1,
          "name": "Количество",
          "type": "number",
          "format": "#,##0"
        },
        {
          "index": 2,
          "name": "Цена",
          "type": "number",
          "format": "#,##0.00"
        }
      ]
    }
  response: |
    {
      "metadata": {
        "version": "1.0"
      },
      "worksheet": {
        "name": "Продажи",
        "range": "A1:C4"
      },
      "data": {
        "header": {
          "values": ["Продукт", "Количество", "Цена"],
          "style": {
            "font_weight": "bold"
          }
        },
        "rows": [
          {
            "values": ["Товар A", 100, 1500]
          },
          {
            "values": ["Товар B", 250, 800]
          }
        ]
      },
      "columns": [
        {
          "index": 0,
          "name": "Продукт",
          "type": "string",
          "format": "text"
        },
        {
          "index": 1,
          "name": "Количество",
          "type": "number",
          "format": "#,##0",
          "style": {
            "horizontal_alignment": "right"
          }
        },
        {
          "index": 2,
          "name": "Цена",
          "type": "number",
          "format": "#,##0.00",
          "style": {
            "horizontal_alignment": "right"
          }
        }
      ]
    }
prompt: |
  Ты — виртуальный ассистент для форматирования данных в электронных таблицах Р7-Офис.
  Ты получаешь данные в формате JSON, который включает структурированную информацию о таблице.
  Твоя задача - применить указанные пользователем изменения форматирования к таблице.
  
  Всегда предоставляй результат в формате расширенных данных таблицы, сохраняя структуру JSON.
  При обработке запросов пользователя следуй инструкциям и применяй соответствующие изменения к стилям.
  
  При работе со стилями используй следующие параметры:
  - background_color: цвет фона в формате hex
  - font_color: цвет шрифта в формате hex
  - font_weight: насыщенность шрифта (normal, bold)
  - font_style: стиль шрифта (normal, italic)
  - font_size: размер шрифта в пунктах
  - horizontal_alignment: горизонтальное выравнивание (left, center, right)
  - vertical_alignment: вертикальное выравнивание (top, middle, bottom)

examples:
- request: |
    ЗАДАЧА: Примени чередующиеся цвета строк для улучшения читаемости
    
    РАСШИРЕННЫЕ ДАННЫЕ ТАБЛИЦЫ:
    {
      "metadata": {
        "version": "1.0"
      },
      "worksheet": {
        "name": "Отчет",
        "range": "A1:C4"
      },
      "styles": [
        {
          "id": "header_style",
          "background_color": "#4472C4",
          "font_color": "#FFFFFF",
          "font_weight": "bold",
          "font_size": "11"
        },
        {
          "id": "row_style",
          "background_color": "#FFFFFF",
          "font_weight": "normal",
          "font_style": "normal",
          "font_size": "11"
        }
      ],
      "data": {
        "header": {
          "values": ["Дата", "Описание", "Сумма"],
          "style": "header_style"
        },
        "rows": [
          {
            "values": ["01.01.2024", "Продажа товара", 15000],  
            "style": "row_style"
          },
          {
            "values": ["02.01.2024", "Покупка материалов", -8000],
            "style": "row_style"
          },
          {
            "values": ["03.01.2024", "Оплата услуг", -3000],
            "style": "row_style"
          }
        ]
      }
    }
  response: |
    {
      "metadata": {
        "version": "1.0"
      },
      "worksheet": {
        "name": "Отчет",
        "range": "A1:C4"
      },
      "styles": [
        {
          "id": "header_style",
          "background_color": "#4472C4",
          "font_color": "#FFFFFF",
          "font_weight": "bold",
          "font_size": "11"
        },
        {
          "id": "even_row_style",
          "background_color": "#F2F2F2",
          "font_weight": "normal",
          "font_style": "normal",
          "font_size": "11"
        },
        {
          "id": "odd_row_style",
          "background_color": "#FFFFFF",
          "font_weight": "normal",
          "font_style": "normal",
          "font_size": "11"
        }
      ],
      "data": {
        "header": {
          "values": ["Дата", "Описание", "Сумма"],
          "style": "header_style"
        },
        "rows": [
          {
            "values": ["01.01.2024", "Продажа товара", 15000],
            "style": "even_row_style"
          },
          {
            "values": ["02.01.2024", "Покупка материалов", -8000],
            "style": "odd_row_style"
          },
          {
            "values": ["03.01.2024", "Оплата услуг", -3000],
            "style": "even_row_style"
          }
        ]
      }
    }
- request: |
    ЗАДАЧА: Выдели отрицательные значения в столбце "Сумма" красным цветом
    
    РАСШИРЕННЫЕ ДАННЫЕ ТАБЛИЦЫ:
    {
      "metadata": {
        "version": "1.0"
      },
      "worksheet": {
        "name": "Финансы",
        "range": "A1:C5"
      },
      "styles": [
        {
          "id": "header_style",
          "background_color": "#4472C4",
          "font_color": "#FFFFFF",
          "font_weight": "bold",
          "font_size": "11"
        },
        {
          "id": "even_row_style",
          "background_color": "#F2F2F2",
          "font_weight": "normal",
          "font_style": "normal",
          "font_size": "11"
        },
        {
          "id": "odd_row_style",
          "background_color": "#FFFFFF",
          "font_weight": "normal",
          "font_style": "normal",
          "font_size": "11"
        }
      ],
      "data": {
        "header": {
          "values": ["Дата", "Описание", "Сумма"],
          "style": "header_style"
        },
        "rows": [
          {
            "values": ["01.01.2024", "Продажа", 15000],
            "style": "even_row_style"
          },
          {
            "values": ["02.01.2024", "Покупка", -8000],
            "style": "odd_row_style"
          },
          {
            "values": ["03.01.2024", "Оплата", -3000],
            "style": "even_row_style"
          },
          {
            "values": ["04.01.2024", "Возврат", 2500],
            "style": "odd_row_style"
          }
        ]
      },
      "columns": [
        {
          "index": 0,
          "format": "dd/mm/yyyy"
        },
        {
          "index": 1,
          "format": "General"
        },
        {
          "index": 2,
          "format": "#,##0.00"
        }
      ]
    }
  response: |
    {
      "metadata": {
        "version": "1.0"
      },
      "worksheet": {
        "name": "Финансы",
        "range": "A1:C5"
      },
      "styles": [
        {
          "id": "header_style",
          "background_color": "#4472C4",
          "font_color": "#FFFFFF",
          "font_weight": "bold",
          "font_size": "11"
        },
        {
          "id": "even_row_style",
          "background_color": "#F2F2F2",
          "font_weight": "normal",
          "font_style": "normal",
          "font_size": "11"
        },
        {
          "id": "odd_row_style",
          "background_color": "#FFFFFF",
          "font_weight": "normal",
          "font_style": "normal",
          "font_size": "11"
        },
        {
          "id": "negative_value_style",
          "font_color": "#FF0000",
          "font_weight": "normal",
          "font_style": "normal",
          "font_size": "11"
        }
      ],
      "data": {
        "header": {
          "values": ["Дата", "Описание", "Сумма"],
          "style": "header_style"
        },
        "rows": [
          {
            "values": ["01.01.2024", "Продажа", 15000],
            "style": "even_row_style"
          },
          {
            "values": ["02.01.2024", "Покупка", -8000],
            "style": "negative_value_style"
          },
          {
            "values": ["03.01.2024", "Оплата", -3000],
            "style": "negative_value_style"
          },
          {
            "values": ["04.01.2024", "Возврат", 2500],
            "style": "odd_row_style"
          }
        ]
      },
      "columns": [
        {
          "index": 0,
          "format": "dd/mm/yyyy"
        },
        {
          "index": 1,
          "format": "General"
        },
        {
          "index": 2,
          "format": "#,##0.00"
        }
      ]
    }
- request: |
    ЗАДАЧА: Сделай заголовки жирным шрифтом и переведи столбцы Количество и Цена в числовой формат
    
    РАСШИРЕННЫЕ ДАННЫЕ ТАБЛИЦЫ:
    {
      "metadata": {
        "version": "1.0"
      },
      "worksheet": {
        "name": "Продажи",
        "range": "A1:C4"
      },
      "styles": [
        {
          "id": "header_style",
          "background_color": "#4472C4",
          "font_color": "#FFFFFF",
          "font_weight": "normal",
          "font_size": "11"
        },
        {
          "id": "row_style",
          "background_color": "#FFFFFF",
          "font_weight": "normal",
          "font_style": "normal",
          "font_size": "11"
        }
      ],
      "data": {
        "header": {
          "values": ["Продукт", "Количество", "Цена"],
          "style": "header_style"
        },
        "rows": [
          {
            "values": ["Товар A", "100", "1500"],
            "style": "row_style"
          },
          {
            "values": ["Товар B", "250", "800"],
            "style": "row_style"
          }
        ]
      },
      "columns": [
        {
          "index": 0,
          "format": "General"
        },
        {
          "index": 1,
          "format": "General"
        },
        {
          "index": 2,
          "format": "General"
        }
      ]
    }
  response: |
    {
      "metadata": {
        "version": "1.0"
      },
      "worksheet": {
        "name": "Продажи",
        "range": "A1:C4"
      },
      "styles": [
        {
          "id": "header_style",
          "background_color": "#4472C4",
          "font_color": "#FFFFFF",
          "font_weight": "bold",
          "font_size": "11"
        },
        {
          "id": "row_style",
          "background_color": "#FFFFFF",
          "font_weight": "normal",
          "font_style": "normal",
          "font_size": "11"
        }
      ],
      "data": {
        "header": {
          "values": ["Продукт", "Количество", "Цена"],
          "style": "header_style"
        },
        "rows": [
          {
            "values": ["Товар A", 100, 1500],
            "style": "row_style"
          },
          {
            "values": ["Товар B", 250, 800],
            "style": "row_style"
          }
        ]
      },
      "columns": [
        {
          "index": 0,
          "format": "General"
        },
        {
          "index": 1,
          "format": "#,##0"
        },
        {
          "index": 2,
          "format": "#,##0.00"
        }
      ]
    }